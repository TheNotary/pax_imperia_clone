<html>
    <head>
        <script type="importmap">
            {
              "imports": {
                "three": "https://unpkg.com/three@0.147.0/build/three.module.js"
              }
            }
          </script>

        <link rel="stylesheet" href="../css/style.css">
    </head>
    <h1>System: Sol</h1>

    <div>
        <span class="console-message">
            Game Paused
        </span></div>

    <div class="flex-container">
        <div class="planet-list">
            <h3>Planets:</h3>
            <ul>
                <li>Mercury</li>
                <li>Venus</li>
                <li>Earth</li>
                <li>Mars</li>
                <li>Jupiter</li>
                <li>Saturn</li>
                <li>Uranus</li>
                <li>Neptune</li>
                <li>Pluto</li>
            </ul>
            <button>Governor</button>
        </div>

        <div>
            <div id="canvas-div"></div>
            <!-- <canvas id="canvas" width="800" height="600" style="border: solid 1px;"></canvas> -->
        </div>

        
    </div>

    <div>
        Lower Console
    </div>


<script type="module">

    import * as THREE from 'three';
    import { GLTFLoader } from "https://cdn.jsdelivr.net/npm/three@0.147.0/examples/jsm/loaders/GLTFLoader.js";

    var t = 0;


    const renderer = new THREE.WebGLRenderer();

    const width = 800;
    const height = 600;
    renderer.setSize( width, height );
    renderer.shadowMap.enabled = true;
    renderer.gammaOutput = true;
    document.getElementById("canvas-div").appendChild( renderer.domElement );
    

    
    const scene = new THREE.Scene();

    ////////////////
    // Add Lights //
    ////////////////

    var light = new THREE.DirectionalLight( 0xffffff, 1 );
    light.position.set(22, 22, 25);
    light.lookAt(0,0,0);
    scene.add( light );
    
    light = new THREE.DirectionalLight( 0xffffff, 1 );
    light.position.set(2, 2, 5);
    light.lookAt(0,0,0);
    scene.add( light );

    light = new THREE.AmbientLight( 0xffffff, 0.1 );
    //light.position.set(-10, -10, 5);
    //light.lookAt(0,0,0);
    scene.add( light );

    ///////////////////
    // Add    Camera //
    ///////////////////

    const camera = new THREE.PerspectiveCamera( 45, width / height, 0.1, 1000 );
    camera.position.set( 0, 40, 0 );
    // camera.position.set( 0, 1, 10 );
    //camera.rotation.set( -90, 0, 0);

    camera.lookAt( 0, 0, 0 );

    var earthScene;

    const loader = new GLTFLoader();
    loader.load( '/public/assets/CloudyPlanet.gltf', function ( gltf ) {

        // Question:
        //   How do I load all the files, and only start the scene after everything is loaded up?
        ////

        ///////////////
        // Add earth //
        ///////////////

        earthScene = gltf.scene;
        // earthScene.scale.set(1.1,1.1,1.1)
        earthScene.position.set(0,0,20)
        scene.add( earthScene );

        console.log("Finished loading!");

    }, function ( xhr ) {
        console.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' );
    }, function ( error ) {
        console.error( error );
    } );

    var sunScene;

    loader.load( '/public/assets/Sun.gltf', function ( gltf ) {
        sunScene = gltf.scene;
        sunScene.position.set(0, 0, 0);
        scene.add( sunScene );

    }, function ( xhr ) {
        console.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' );
    }, function ( error ) {
        console.error( error );
    } );


    function draw() {
        t += 1/480;
        if (earthScene != undefined) {
            earthScene.position.x = 10*Math.cos(t) + 0;
            //earthScene.position.y = 5*Math.cos(t) + 0;
            earthScene.position.z = 10*Math.sin(t) + 0;

            //earthScene.rotation.y += 0.005;
        }

        // const whitePlanet = scene.getObjectByName('Scene');
        // if (whitePlanet != undefined) {
        //     whitePlanet.position.x += 0.01;
        //     whitePlanet.rotation.y += 0.005;
        // }

        renderer.render( scene, camera );
        requestAnimationFrame(draw);
    }

    draw();




    // DRAW BOX

    // const boxGeometry = new THREE.BoxGeometry(1,1,1);
    // const boxMaterial = new THREE.LineBasicMaterial( { color: 'red' } );
    // const boxMesh = new THREE.Mesh(boxGeometry, boxMaterial);
    // scene.add( boxMesh );

    // // DRAW LINE
    // const points = [];
    // points.push( new THREE.Vector3( - 10, 0, 0 ) );
    // points.push( new THREE.Vector3( 0, 10, 0 ) );
    // points.push( new THREE.Vector3( 10, 0, 0 ) );

    // const lineGeometry = new THREE.BufferGeometry().setFromPoints( points );
    // const lineMaterial = new THREE.LineBasicMaterial( { color: 0x0000ff } );
    // const line = new THREE.Line( lineGeometry, lineMaterial );
    // scene.add( line );

    // // DRAW SPHERE
    // const geometry = new THREE.SphereGeometry( 15, 32, 16 );
    // const material = new THREE.MeshBasicMaterial( { color: 0xffff00 } );
    // const sphere = new THREE.Mesh( geometry, material );
    // scene.add( sphere );



  </script>
  
    

</html>